<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <meta charset="utf-8" />
  <style>
    body { font-family: Arial; background:#f4f6f7; }
    .box { width:450px; margin:60px auto; background:#fff; padding:20px; border-radius:8px }
    textarea,select,button { width:100%; padding:10px; margin-top:10px }
    button { background:#2c3e50; color:#fff; border:none }
  </style>
</head>
<body>

<div class="box">
  <h2>Create Tap-to-Reveal Link</h2>

  <select id="lang">
    <option value="en">English</option>
    <option value="ta">Tamil</option>
  </select>

  <select id="mode">
    <option value="one-time">One Time Reveal</option>
    <option value="always">Always Active</option>
  </select>

  <textarea id="message" placeholder="Secret message..."></textarea>

  <button onclick="createLink()">Generate Link</button>

  <p id="result"></p>
</div>

<button onclick="logout()" style="position:fixed;top:10px;right:10px">Logout</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDAlt16C36DGhonXf10URIhz82LroH2k3A",
  authDomain: "tap-to-reveal.firebaseapp.com",
  projectId: "tap-to-reveal",
  storageBucket: "tap-to-reveal.firebasestorage.app",
  messagingSenderId: "878205314791",
  appId: "1:878205314791:web:ce3c831e7075c27ca8a442"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

if (!sessionStorage.getItem("admin")) {
  location.href = "admin.html";
}

function createLink() {
  const id = Math.random().toString(36).substr(2,8);

  db.collection("reveals").doc(id).set({
    message: message.value,
    lang: lang.value,
    mode: mode.value,
    revealed: false,
    createdAt: new Date()
  }).then(() => {
    result.innerText =
      location.origin +
      "/tap-to-reveal/index.html?id=" + id;
  });
}

function logout() {
  sessionStorage.clear();
  location.href = "admin.html";
}
</script>

</body>
</html>
