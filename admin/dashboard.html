<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDLR2viVk-4QuaEODUzcrvqIWYbWYP7WGI",
  authDomain: "surprise-f507b.firebaseapp.com",
  databaseURL: "https://surprise-f507b-default-rtdb.firebaseio.com",
  projectId: "surprise-f507b",
  storageBucket: "surprise-f507b.firebasestorage.app",
  messagingSenderId: "1027446628296",
  appId: "1:1027446628296:web:88fa311bd4de230375eafd"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const btn = document.getElementById("generateBtn");
const msgInput = document.getElementById("message");
const output = document.getElementById("output");

btn.onclick = async () => {
  const message = msgInput.value.trim();
  if (!message) {
    alert("Enter a message");
    return;
  }

  const id = crypto.randomUUID().slice(0, 8);

  await set(ref(db, "messages/" + id), {
    message,
    createdAt: Date.now()
  });

  const link = `${location.origin}/tap-to-reveal/index.html?id=${id}`;
  output.innerHTML = `
    <p><b>Link generated:</b></p>
    <a href="${link}" target="_blank">${link}</a>
  `;
};
</script>
